<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Subroutines</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="PLEAC-Python
"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="Directories"
HREF="directories.html"><LINK
REL="NEXT"
TITLE="References and Records"
HREF="referencesandrecords.html"><style type="text/css">    <!--
      .comment {
        /* font-lock-comment-face */
        color: #bebebe;
      }
      .comment-delimiter {
      }
      .function-name {
        /* font-lock-function-name-face */
        color: #b2dfee;
      }
      .keyword {
        /* font-lock-keyword-face */
        color: #ffa500;
      }
      .py-builtins {
        /* py-builtins-face */
        color: #ffa500;
      }
      .py-pseudo-keyword {
        /* py-pseudo-keyword-face */
        color: #ffa500;
      }
      .string {
        /* font-lock-string-face */
        color: #00cd00;
      }
      .type {
        /* font-lock-type-face */
        color: #98fb98;
      }
    -->
    </style></head
><BODY TEXT="#cecece" BGCOLOR="#4f6f6f" LINK="#f5deb3" VLINK="#d5ae83"
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PLEAC-Python
</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="directories.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="referencesandrecords.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="SUBROUTINES"
>10. Subroutines</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN536"
>Introduction</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="comment-delimiter"></span><span class="comment"></span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="comment-delimiter"># </span><span class="comment">DO NOT DO THIS...
</span>greeted = 0
<span class="keyword">def</span> <span class="function-name">hello</span>():
    <span class="keyword">global</span> greeted
    greeted += 1
    <span class="keyword">print</span> <span class="string">"hi there"</span>

<span class="comment-delimiter">#</span><span class="comment">... as using a callable object to save state is cleaner
</span><span class="comment-delimiter"># </span><span class="comment">class hello
</span><span class="comment-delimiter">#     </span><span class="comment">def __init__(self):
</span><span class="comment-delimiter">#         </span><span class="comment">self.greeted = 0
</span><span class="comment-delimiter">#     </span><span class="comment">def __call__(self):
</span><span class="comment-delimiter">#         </span><span class="comment">self.greeted += 1
</span><span class="comment-delimiter">#         </span><span class="comment">print "hi there"
</span><span class="comment-delimiter"># </span><span class="comment">hello = hello()
</span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span>hello()                 <span class="comment-delimiter"># </span><span class="comment">call subroutine hello with no arguments/parameters
</span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN539"
>Accessing Subroutine Arguments</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="comment-delimiter"></span><span class="comment"></span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="keyword">import</span> math
<span class="comment-delimiter"># </span><span class="comment">Provided for demonstration purposes only.  Use math.hypot() instead.
</span><span class="keyword">def</span> <span class="function-name">hypotenuse</span>(side1, side2):
    <span class="keyword">return</span> math.sqrt(side1**2 + side2**2)

diag = hypotenuse(3, 4)  <span class="comment-delimiter"># </span><span class="comment">diag is 5.0
</span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="keyword">print</span> hypotenuse(3, 4)               <span class="comment-delimiter"># </span><span class="comment">prints 5.0
</span>
a = (3, 4)
<span class="keyword">print</span> hypotenuse(*a)                 <span class="comment-delimiter"># </span><span class="comment">prints 5.0
</span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span>both = men + women
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span>nums = [1.4, 3.5, 6.7]
<span class="comment-delimiter"># </span><span class="comment">Provided for demonstration purposes only.  Use:
</span><span class="comment-delimiter">#     </span><span class="comment">ints = [int(num) for num in nums] 
</span><span class="keyword">def</span> <span class="function-name">int_all</span>(nums):
    retlist = []            <span class="comment-delimiter"># </span><span class="comment">make new list for return
</span>    <span class="keyword">for</span> n <span class="keyword">in</span> nums:
        retlist.append(<span class="py-builtins">int</span>(n))
    <span class="keyword">return</span> retlist
ints = int_all(nums)        <span class="comment-delimiter"># </span><span class="comment">nums unchanged
</span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span>nums = [1.4, 3.5, 6.7]

<span class="keyword">def</span> <span class="function-name">trunc_em</span>(nums):
    <span class="keyword">for</span> i,elem <span class="keyword">in</span> <span class="py-builtins">enumerate</span>(nums):
        nums[i] = <span class="py-builtins">int</span>(elem)
trunc_em(nums)               <span class="comment-delimiter"># </span><span class="comment">nums now [1,3,6]
</span>
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="comment-delimiter"># </span><span class="comment">By convention, if a method (or function) modifies an object
</span><span class="comment-delimiter"># </span><span class="comment">in-place, it returns None rather than the modified object.
</span><span class="comment-delimiter"># </span><span class="comment">None of Python's built-in functions modify in-place; methods
</span><span class="comment-delimiter"># </span><span class="comment">such as list.sort() are somewhat more common.
</span>mylist = [3,2,1]
mylist = mylist.sort()   <span class="comment-delimiter"># </span><span class="comment">incorrect - returns None
</span>mylist = sorted(mylist)  <span class="comment-delimiter"># </span><span class="comment">correct - returns sorted copy
</span>mylist.sort()            <span class="comment-delimiter"># </span><span class="comment">correct - sorts in-place
</span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN542"
>Making Variables Private to a Function</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="comment-delimiter"></span><span class="comment"></span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="comment-delimiter"># </span><span class="comment">Using global variables is discouraged - by default variables
</span><span class="comment-delimiter"># </span><span class="comment">are visible only at and below the scope at which they are declared.
</span><span class="comment-delimiter"># </span><span class="comment">Global variables modified by a function or method must be declared 
</span><span class="comment-delimiter"># </span><span class="comment">using the "global" keyword if they are modified
</span><span class="keyword">def</span> <span class="function-name">somefunc</span>():
    variable = something  <span class="comment-delimiter"># </span><span class="comment">variable is invisible outside of somefunc
</span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="keyword">import</span> sys
name, age = sys.args[1:]  <span class="comment-delimiter"># </span><span class="comment">assumes two and only two command line parameters
</span>start = fetch_time()
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span>a, b = pair
c = fetch_time()

<span class="keyword">def</span> <span class="function-name">check_x</span>(x):
    y = <span class="string">"whatever"</span>
    run_check()
    <span class="keyword">if</span> condition:
        <span class="keyword">print</span> <span class="string">"got"</span>, x
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="keyword">def</span> <span class="function-name">save_list</span>(*args):
    Global_List.extend(args)
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN545"
>Creating Persistent Private Variables</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="comment-delimiter"></span><span class="comment"></span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="comment-delimiter">#</span><span class="comment"># Python allows static nesting of scopes for reading but not writing,
</span><span class="comment-delimiter">#</span><span class="comment"># preferring to use objects.  The closest equivalent to:
</span><span class="comment-delimiter">#</span><span class="comment">{
</span><span class="comment-delimiter">#    </span><span class="comment">my $counter;
</span><span class="comment-delimiter">#    </span><span class="comment">sub next_counter { return ++$counter }
</span><span class="comment-delimiter">#</span><span class="comment">}
</span><span class="comment-delimiter">#</span><span class="comment"># is:
</span><span class="keyword">def</span> <span class="function-name">next_counter</span>(counter=[0]):  <span class="comment-delimiter"># </span><span class="comment">default lists are created once only.
</span>    counter[0] += 1
    <span class="keyword">return</span> counter[0]

<span class="comment-delimiter"># </span><span class="comment">As that's a little tricksy (and can't make more than one counter),
</span><span class="comment-delimiter"># </span><span class="comment">many Pythonistas would prefer either:
</span><span class="keyword">def</span> <span class="function-name">make_counter</span>():
    counter = 0
    <span class="keyword">while</span> <span class="py-pseudo-keyword">True</span>:
        counter += 1
        <span class="keyword">yield</span> counter
next_counter = make_counter().next

<span class="comment-delimiter"># </span><span class="comment">Or:
</span><span class="keyword">class</span> <span class="type">Counter</span>:
    <span class="keyword">def</span> <span class="function-name">__init__</span>(<span class="py-pseudo-keyword">self</span>):
        <span class="py-pseudo-keyword">self</span>.counter = 0
    <span class="keyword">def</span> <span class="function-name">__call__</span>(<span class="py-pseudo-keyword">self</span>):
        <span class="py-pseudo-keyword">self</span>.counter += 1
        <span class="keyword">return</span> <span class="py-pseudo-keyword">self</span>.counter
next_counter = Counter()

<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="comment-delimiter">#</span><span class="comment"># A close equivalent of
</span><span class="comment-delimiter">#</span><span class="comment">BEGIN {
</span><span class="comment-delimiter">#    </span><span class="comment">my $counter = 42;
</span><span class="comment-delimiter">#    </span><span class="comment">sub next_counter { return ++$counter }
</span><span class="comment-delimiter">#    </span><span class="comment">sub prev_counter { return --$counter }
</span><span class="comment-delimiter">#</span><span class="comment">}
</span><span class="comment-delimiter">#</span><span class="comment"># is to use a list (to save the counter) and closured functions:
</span><span class="keyword">def</span> <span class="function-name">make_counter</span>(start=0):
    counter = [start]
    <span class="keyword">def</span> <span class="function-name">next_counter</span>():
        counter[0] += 1
        <span class="keyword">return</span> counter[0]
    <span class="keyword">def</span> <span class="function-name">prev_counter</span>():
        counter[0] -= 1
        <span class="keyword">return</span> counter[0]
    <span class="keyword">return</span> next_counter, prev_counter
next_counter, prev_counter = make_counter()

<span class="comment-delimiter">#</span><span class="comment"># A clearer way uses a class:
</span><span class="keyword">class</span> <span class="type">Counter</span>:
    <span class="keyword">def</span> <span class="function-name">__init__</span>(<span class="py-pseudo-keyword">self</span>, start=0):
        <span class="py-pseudo-keyword">self</span>.value = start
    <span class="keyword">def</span> <span class="function-name">next</span>(<span class="py-pseudo-keyword">self</span>):
        <span class="py-pseudo-keyword">self</span>.value += 1
        <span class="keyword">return</span> <span class="py-pseudo-keyword">self</span>.value
    <span class="keyword">def</span> <span class="function-name">prev</span>(<span class="py-pseudo-keyword">self</span>):
        <span class="py-pseudo-keyword">self</span>.value -= 1
        <span class="keyword">return</span> <span class="py-pseudo-keyword">self</span>.value
    <span class="keyword">def</span> <span class="function-name">__int__</span>(<span class="py-pseudo-keyword">self</span>):
        <span class="keyword">return</span> <span class="py-pseudo-keyword">self</span>.value

counter = Counter(42)
next_counter = counter.next
prev_counter = counter.prev
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN548"
>Determining Current Function Name</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="comment-delimiter"></span><span class="comment"></span><span class="comment-delimiter">#</span><span class="comment"># This sort of code inspection is liable to change as
</span><span class="comment-delimiter">#</span><span class="comment"># Python evolves.  There may be cleaner ways to do this.
</span><span class="comment-delimiter">#</span><span class="comment"># This also may not work for code called from functions
</span><span class="comment-delimiter">#</span><span class="comment"># written in C.
</span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="keyword">import</span> sys
this_function = sys._getframe(0).f_code.co_name
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span>i = 0 <span class="comment-delimiter"># </span><span class="comment">how far up the call stack to look
</span>module = sys._getframe(i).f_globals[<span class="string">"__name__"</span>]
filename = sys._getframe(i).f_code.co_filename
line = sys._getframe(i).f_lineno
subr = sys._getframe(i).f_code.co_name
has_args = <span class="py-builtins">bool</span>(sys._getframe(i+1).f_code.co_argcount)

<span class="comment-delimiter"># </span><span class="comment">'wantarray' is Perl specific
</span>
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span>me = whoami()
him = whowasi()

<span class="keyword">def</span> <span class="function-name">whoami</span>():
    sys._getframe(1).f_code.co_name
<span class="keyword">def</span> <span class="function-name">whowasi</span>():
    sys._getframe(2).f_code.co_name
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN551"
>Passing Arrays and Hashes by Reference</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="comment-delimiter"></span><span class="comment"></span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="comment-delimiter"># </span><span class="comment">Every variable name is a reference to an object, thus nothing special
</span><span class="comment-delimiter"># </span><span class="comment">needs to be done to pass a list or a dict as a parameter.
</span>list_diff(list1, list2)
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="comment-delimiter"># </span><span class="comment">Note: if one parameter to zip() is longer it will be truncated
</span><span class="keyword">def</span> <span class="function-name">add_vecpair</span>(x, y):
    <span class="keyword">return</span> [x1+y1 <span class="keyword">for</span> x1, y1 <span class="keyword">in</span> <span class="py-builtins">zip</span>(x, y)]

a = [1, 2]
b = [5, 8]
<span class="keyword">print</span> <span class="string">" "</span>.join([<span class="py-builtins">str</span>(n) <span class="keyword">for</span> n <span class="keyword">in</span> add_vecpair(a, b)])
<span class="comment-delimiter">#</span><span class="comment">=&gt; 6 10
</span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="comment-delimiter"># </span><span class="comment">DO NOT DO THIS:
</span><span class="keyword">assert</span> <span class="py-builtins">isinstance</span>(x, <span class="py-builtins">type</span>([])) <span class="keyword">and</span> <span class="py-builtins">isinstance</span>(y, <span class="py-builtins">type</span>([])), \
    <span class="string">"usage: add_vecpair(list1, list2)"</span>
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN554"
>Detecting Return Context</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="comment-delimiter"></span><span class="comment"></span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="comment-delimiter"># </span><span class="comment">perl return context is not something standard in python...
</span><span class="comment-delimiter"># </span><span class="comment">but still you can achieve something alike if you really need it
</span><span class="comment-delimiter"># </span><span class="comment">(but you must really need it badly since you should never use this!!)
</span><span class="comment-delimiter">#</span><span class="comment">
</span><span class="comment-delimiter"># </span><span class="comment">see http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/284742 for more
</span><span class="comment-delimiter">#</span><span class="comment">
</span><span class="comment-delimiter"># </span><span class="comment">NB: it has been tested under Python 2.3.x and no guarantees can be given
</span><span class="comment-delimiter">#     </span><span class="comment">that it works under any future Python version.
</span><span class="keyword">import</span> inspect,dis

<span class="keyword">def</span> <span class="function-name">expecting</span>():
    <span class="string">"""Return how many values the caller is expecting"""</span>
    f = inspect.currentframe().f_back.f_back
    bytecode = f.f_code.co_code
    i = f.f_lasti
    instruction = <span class="py-builtins">ord</span>(bytecode[i+3])
    <span class="keyword">if</span> instruction == dis.opmap[<span class="string">'UNPACK_SEQUENCE'</span>]:
        howmany = <span class="py-builtins">ord</span>(bytecode[i+4])
        <span class="keyword">return</span> howmany
    <span class="keyword">elif</span> instruction == dis.opmap[<span class="string">'POP_TOP'</span>]:
        <span class="keyword">return</span> 0
    <span class="keyword">return</span> 1

<span class="keyword">def</span> <span class="function-name">cleverfunc</span>():
    howmany = expecting()
    <span class="keyword">if</span> howmany == 0:
        <span class="keyword">print</span> <span class="string">"return value discarded"</span>
    <span class="keyword">if</span> howmany == 2:
        <span class="keyword">return</span> 1,2
    <span class="keyword">elif</span> howmany == 3:
        <span class="keyword">return</span> 1,2,3
    <span class="keyword">return</span> 1

cleverfunc()
x = cleverfunc()
<span class="keyword">print</span> x
x,y = cleverfunc()
<span class="keyword">print</span> x,y
x,y,z = cleverfunc()
<span class="keyword">print</span> x,y,z</PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN557"
>Passing by Named Parameter</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="comment-delimiter"></span><span class="comment"></span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span>thefunc(increment= <span class="string">"20s"</span>, start=<span class="string">"+5m"</span>, finish=<span class="string">"+30m"</span>)
thefunc(start= <span class="string">"+5m"</span>,finish=<span class="string">"+30m"</span>)
thefunc(finish= <span class="string">"+30m"</span>)
thefunc(start=<span class="string">"+5m"</span>, increment=<span class="string">"15s"</span>)
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="keyword">def</span> <span class="function-name">thefunc</span>(increment=<span class="string">'10s'</span>,
            finish=<span class="string">'0'</span>,
            start=<span class="string">'0'</span>):
    <span class="keyword">if</span> increment.endswith(<span class="string">"m"</span>):
        <span class="keyword">pass</span>
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN560"
>Skipping Selected Return Values</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="comment-delimiter"></span><span class="comment"></span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span>a, _, c = func()       <span class="comment-delimiter"># </span><span class="comment">Use _ as a placeholder...
</span>a, ignore, c = func()  <span class="comment-delimiter"># </span><span class="comment">...or assign to an otherwise unused variable
</span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN563"
>Returning More Than One Array or Hash</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="comment-delimiter"></span><span class="comment"></span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="keyword">def</span> <span class="function-name">somefunc</span>():
    mylist = []
    mydict = {}
    <span class="comment-delimiter"># </span><span class="comment">...
</span>    <span class="keyword">return</span> mylist, mydict

mylist, mydict = somefunc()
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="keyword">def</span> <span class="function-name">fn</span>():
    <span class="keyword">return</span> a, b, c

<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span>h0, h1, h2 = fn()
tuple_of_dicts = fn()   <span class="comment-delimiter"># </span><span class="comment">eg: tuple_of_dicts[2]["keystring"]
</span>r0, r1, r2 = fn()       <span class="comment-delimiter"># </span><span class="comment">eg: r2["keystring"]
</span>
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN566"
>Returning Failure</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="comment-delimiter"></span><span class="comment"></span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="comment-delimiter"># </span><span class="comment">Note: Exceptions are almost always preferred to error values
</span><span class="keyword">return</span>
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="keyword">def</span> <span class="function-name">empty_retval</span>():
    <span class="keyword">return</span> <span class="py-pseudo-keyword">None</span>

<span class="keyword">def</span> <span class="function-name">empty_retval</span>():
    <span class="keyword">return</span>          <span class="comment-delimiter"># </span><span class="comment">identical to return None
</span>
<span class="keyword">def</span> <span class="function-name">empty_retval</span>():
    <span class="keyword">pass</span>            <span class="comment-delimiter"># </span><span class="comment">None returned by default (empty func needs pass)
</span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span>a = yourfunc()
<span class="keyword">if</span> a:
    <span class="keyword">pass</span>
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span>a = sfunc()
<span class="keyword">if</span> <span class="keyword">not</span> a:
    <span class="keyword">raise</span> <span class="py-builtins">AssertionError</span>(<span class="string">"sfunc failed"</span>)

<span class="keyword">assert</span> sfunc(), <span class="string">"sfunc failed"</span>
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN569"
>Prototyping Functions</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="comment-delimiter"></span><span class="comment"></span><span class="comment-delimiter"># </span><span class="comment">Prototypes are inapplicable to Python as Python disallows calling
</span><span class="comment-delimiter"># </span><span class="comment">functions without using brackets, and user functions are able to
</span><span class="comment-delimiter"># </span><span class="comment">mimic built-in functions with no special actions required as they
</span><span class="comment-delimiter"># </span><span class="comment">only flatten lists (and convert dicts to named arguments) if
</span><span class="comment-delimiter"># </span><span class="comment">explicitly told to do so.  Python functions use named parameters
</span><span class="comment-delimiter"># </span><span class="comment">rather than shifting arguments:
</span>
<span class="keyword">def</span> <span class="function-name">myfunc</span>(a, b, c=4):
   <span class="keyword">print</span> a, b, c

mylist = [1,2]

mydict1 = {<span class="string">"b"</span>: 2, <span class="string">"c"</span>: 3}
mydict2 = {<span class="string">"b"</span>: 2}

myfunc(1,2,3)
<span class="comment-delimiter">#</span><span class="comment">=&gt; 1 2 3
</span>
myfunc(1,2)
<span class="comment-delimiter">#</span><span class="comment">=&gt; 1 2 4
</span>
myfunc(*mylist)
<span class="comment-delimiter">#</span><span class="comment">=&gt; 1 2 4
</span>
myfunc(5, *mylist)
<span class="comment-delimiter">#</span><span class="comment">=&gt; 5, 1, 2
</span>
myfunc(5, **mydict1)
<span class="comment-delimiter">#</span><span class="comment">=&gt; 5, 2, 3
</span>
myfunc(5, **mydict2)
<span class="comment-delimiter">#</span><span class="comment">=&gt; 5, 2, 4
</span>
myfunc(c=3, b=2, a=1)
<span class="comment-delimiter">#</span><span class="comment">=&gt; 1, 2, 3
</span>
myfunc(b=2, a=1)
<span class="comment-delimiter">#</span><span class="comment">=&gt; 1, 2, 4
</span>
myfunc(mylist, mydict1)
<span class="comment-delimiter">#</span><span class="comment">=&gt; [1, 2] {'c': 3, 'b': 2} 4
</span>
<span class="comment-delimiter"># </span><span class="comment">For demonstration purposes only - don't do this
</span><span class="keyword">def</span> <span class="function-name">mypush</span>(mylist, *vals):
   mylist.extend(vals)

mylist = []
mypush(mylist, 1, 2, 3, 4, 5)
<span class="keyword">print</span> mylist
<span class="comment-delimiter">#</span><span class="comment">=&gt; [1, 2, 3, 4, 5]
</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN572"
>Handling Exceptions</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="comment-delimiter"></span><span class="comment"></span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="keyword">raise</span> <span class="py-builtins">ValueError</span>(<span class="string">"some message"</span>)  <span class="comment-delimiter"># </span><span class="comment">specific exception class
</span><span class="keyword">raise</span> <span class="py-builtins">Exception</span>(<span class="string">"use me rarely"</span>)  <span class="comment-delimiter"># </span><span class="comment">general exception
</span><span class="keyword">raise</span> <span class="string">"don't use me"</span>              <span class="comment-delimiter"># </span><span class="comment">string exception (deprecated)
</span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="comment-delimiter"># </span><span class="comment">Note that bare excepts are considered bad style.  Normally you should
</span><span class="comment-delimiter"># </span><span class="comment">trap specific exceptions.  For instance these bare excepts will
</span><span class="comment-delimiter"># </span><span class="comment">catch KeyboardInterrupt, SystemExit, and MemoryError as well as
</span><span class="comment-delimiter"># </span><span class="comment">more common errors.  In addition they force you to import sys to
</span><span class="comment-delimiter"># </span><span class="comment">get the error message.
</span><span class="keyword">import</span> warnings, sys
<span class="keyword">try:</span>
    func()
<span class="keyword">except:</span>
    warnings.warn(<span class="string">"func raised an exception: "</span> + <span class="py-builtins">str</span>(sys.exc_info()[1]))
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="keyword">try:</span>
    func()
<span class="keyword">except:</span>
    warnings.warn(<span class="string">"func blew up: "</span> + <span class="py-builtins">str</span>(sys.exc_info()[1]))
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="keyword">class</span> <span class="type">MoonPhaseError</span>(Exception):
    <span class="keyword">def</span> <span class="function-name">__init__</span>(<span class="py-pseudo-keyword">self</span>, phase):
        <span class="py-pseudo-keyword">self</span>.phase = phase
<span class="keyword">class</span> <span class="type">FullMoonError</span>(MoonPhaseError):
    <span class="keyword">def</span> <span class="function-name">__init__</span>(<span class="py-pseudo-keyword">self</span>):
        MoonPhaseError.__init__(<span class="string">"full moon"</span>)

<span class="keyword">def</span> <span class="function-name">func</span>():
    <span class="keyword">raise</span> FullMoonError()

<span class="comment-delimiter"># </span><span class="comment">Ignore only FullMoonError exceptions
</span><span class="keyword">try:</span>
    func()
<span class="keyword">except</span> FullMoonError:
    <span class="keyword">pass</span>
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="comment-delimiter"># </span><span class="comment">Ignore only MoonPhaseError for a full moon
</span><span class="keyword">try:</span>
    func()
<span class="keyword">except</span> MoonPhaseError, err:
    <span class="keyword">if</span> err.phase != <span class="string">"full moon"</span>:
        <span class="keyword">raise</span>
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN575"
>Saving Global Values</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="comment-delimiter"></span><span class="comment"></span><span class="comment-delimiter"># </span><span class="comment">There is no direct equivalent to 'local' in Python, and
</span><span class="comment-delimiter"># </span><span class="comment">it's impossible to write your own.  But then again, even in
</span><span class="comment-delimiter"># </span><span class="comment">Perl it's considered poor style.
</span>
<span class="comment-delimiter"># </span><span class="comment">DON'T DO THIS (You probably shouldn't use global variables anyway):
</span><span class="keyword">class</span> <span class="type">Local</span>(object):
    <span class="keyword">def</span> <span class="function-name">__init__</span>(<span class="py-pseudo-keyword">self</span>, globalname, val):
        <span class="py-pseudo-keyword">self</span>.globalname = globalname
        <span class="py-pseudo-keyword">self</span>.globalval = <span class="py-builtins">globals</span>()[globalname]
        <span class="py-builtins">globals</span>()[globalname] = val
        
    <span class="keyword">def</span> <span class="function-name">__del__</span>(<span class="py-pseudo-keyword">self</span>):
        <span class="py-builtins">globals</span>()[<span class="py-pseudo-keyword">self</span>.globalname] = <span class="py-pseudo-keyword">self</span>.globalval

foo = 4

<span class="keyword">def</span> <span class="function-name">blah</span>():
    <span class="keyword">print</span> foo

<span class="keyword">def</span> <span class="function-name">blech</span>():
    temp = Local(<span class="string">"foo"</span>, 6)
    blah()

blah()
blech()
blah()

<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN578"
>Redefining a Function</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="comment-delimiter"></span><span class="comment"></span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span>grow = expand
grow()                     <span class="comment-delimiter"># </span><span class="comment">calls expand()
</span>
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span>one.var = two.table   <span class="comment-delimiter"># </span><span class="comment">make one.var the same as two.table
</span>one.big = two.small   <span class="comment-delimiter"># </span><span class="comment">make one.big the same as two.small
</span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span>fred = barney     <span class="comment-delimiter"># </span><span class="comment">alias fred to barney
</span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span>s = red(<span class="string">"careful here"</span>)
<span class="keyword">print</span> s
<span class="comment-delimiter">#</span><span class="comment">&gt; &lt;FONT COLOR='red'&gt;careful here&lt;/FONT&gt;
</span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="comment-delimiter"># </span><span class="comment">Note: the 'text' should be HTML escaped if it can contain
</span><span class="comment-delimiter"># </span><span class="comment">any of the characters '&lt;', '&gt;' or '&amp;'
</span><span class="keyword">def</span> <span class="function-name">red</span>(text):
    <span class="keyword">return</span> <span class="string">"&lt;FONT COLOR='red'&gt;"</span> + text + <span class="string">"&lt;/FONT&gt;"</span>
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="keyword">def</span> <span class="function-name">color_font</span>(color, text):
    <span class="keyword">return</span> <span class="string">"&lt;FONT COLOR='%s'&gt;%s&lt;/FONT&gt;"</span> % (color, text)

<span class="keyword">def</span> <span class="function-name">red</span>(text): <span class="keyword">return</span> color_font(<span class="string">"red"</span>, text)
<span class="keyword">def</span> <span class="function-name">green</span>(text): <span class="keyword">return</span> color_font(<span class="string">"green"</span>, text)
<span class="keyword">def</span> <span class="function-name">blue</span>(text): <span class="keyword">return</span> color_font(<span class="string">"blue"</span>, text)
<span class="keyword">def</span> <span class="function-name">purple</span>(text): <span class="keyword">return</span> color_font(<span class="string">"purple"</span>, text)
<span class="comment-delimiter"># </span><span class="comment">etc
</span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="comment-delimiter"># </span><span class="comment">This is done in Python by making an object, instead of
</span><span class="comment-delimiter"># </span><span class="comment">saving state in a local anonymous context.
</span><span class="keyword">class</span> <span class="type">ColorFont</span>:
    <span class="keyword">def</span> <span class="function-name">__init__</span>(<span class="py-pseudo-keyword">self</span>, color):
        <span class="py-pseudo-keyword">self</span>.color = color
    <span class="keyword">def</span> <span class="function-name">__call__</span>(<span class="py-pseudo-keyword">self</span>, text):
        <span class="keyword">return</span> <span class="string">"&lt;FONT COLOR='%s'&gt;%s&lt;/FONT&gt;"</span> % (<span class="py-pseudo-keyword">self</span>.color, text)

colors = <span class="string">"red blue green yellow orange purple violet"</span>.split(<span class="string">" "</span>)
<span class="keyword">for</span> name <span class="keyword">in</span> colors:
    <span class="py-builtins">globals</span>()[name] = ColorFont(name)
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="comment-delimiter"># </span><span class="comment">If you really don't want to make a new class, you can
</span><span class="comment-delimiter"># </span><span class="comment">fake it somewhat by passing in default args.
</span>colors = <span class="string">"red blue green yellow orange purple violet"</span>.split(<span class="string">" "</span>)
<span class="keyword">for</span> name <span class="keyword">in</span> colors:
    <span class="keyword">def</span> <span class="function-name">temp</span>(text, color = name):
        <span class="keyword">return</span> <span class="string">"&lt;FONT COLOR='%s'&gt;%s&lt;/FONT&gt;"</span> % (color, text)
    <span class="py-builtins">globals</span>()[name] = temp

<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN581"
>Trapping Undefined Function Calls with AUTOLOAD</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="comment-delimiter"></span><span class="comment"></span>
<span class="comment-delimiter"># </span><span class="comment">Python has the ability to derive from ModuleType and add
</span><span class="comment-delimiter"># </span><span class="comment">new __getattr__ and __setattr__ methods.  I don't know the
</span><span class="comment-delimiter"># </span><span class="comment">expected way to use them to emulate Perl's AUTOLOAD.  Instead,
</span><span class="comment-delimiter"># </span><span class="comment">here's how something similar would be done in Python.  This
</span><span class="comment-delimiter"># </span><span class="comment">uses the ColorFont defined above.
</span>
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="keyword">class</span> <span class="type">AnyColor</span>:
    <span class="keyword">def</span> <span class="function-name">__getattr__</span>(<span class="py-pseudo-keyword">self</span>, name):
        <span class="keyword">return</span> ColorFont(name)

colors = AnyColor()

<span class="keyword">print</span> colors.chartreuse(<span class="string">"stuff"</span>)

<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="comment-delimiter">#</span><span class="comment"># Skipping this translation because 'local' is too Perl
</span><span class="comment-delimiter">#</span><span class="comment"># specific, and there isn't enough context to figure out
</span><span class="comment-delimiter">#</span><span class="comment"># what this is supposed to do.
</span><span class="comment-delimiter">#</span><span class="comment">{
</span><span class="comment-delimiter">#    </span><span class="comment">local *yellow = \&amp;violet;
</span><span class="comment-delimiter">#    </span><span class="comment">local (*red, *green) = (\&amp;green, \&amp;red);
</span><span class="comment-delimiter">#    </span><span class="comment">print_stuff();
</span><span class="comment-delimiter">#</span><span class="comment">}
</span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN584"
>Nesting Subroutines</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="comment-delimiter"></span><span class="comment"></span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="keyword">def</span> <span class="function-name">outer</span>(arg1):
    x = arg1 + 35
    <span class="keyword">def</span> <span class="function-name">inner</span>():
        <span class="keyword">return</span> x * 19
    <span class="keyword">return</span> x + inner()
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN587"
>Program: Sorting Your Mail</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="comment-delimiter"></span><span class="comment"></span><span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="keyword">import</span> mailbox, sys
mbox = mailbox.PortableUnixMailbox(sys.stdin)

<span class="keyword">def</span> <span class="function-name">extract_data</span>(msg, idx):
    subject = msg.getheader(<span class="string">"Subject"</span>, <span class="string">""</span>).strip()
    <span class="keyword">if</span> subject[:3].lower() == <span class="string">"re:"</span>:
        subject = subject[3:].lstrip()
    text = msg.fp.read()
    <span class="keyword">return</span> subject, idx, msg, text
messages = [extract_data(idx, msg) <span class="keyword">for</span> idx, msg <span class="keyword">in</span> <span class="py-builtins">enumerate</span>(mbox)]

<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="comment-delimiter"># </span><span class="comment">Sorts by subject then by original position in the list
</span><span class="keyword">for</span> subject, pos, msg, text <span class="keyword">in</span> sorted(messages):
    <span class="keyword">print</span> <span class="string">"%s\n%s"</span>%(msg, text)

<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span><span class="comment-delimiter"># </span><span class="comment">Sorts by subject then date then original position
</span><span class="keyword">def</span> <span class="function-name">subject_date_position</span>(elem):
    <span class="keyword">return</span> (elem[0], elem[2].getdate(<span class="string">"Date"</span>), elem[1])
messages.sort(key=subject_date_position)

<span class="comment-delimiter"># </span><span class="comment">Pre 2.4:
</span>messages = sorted(messages, key=subject_date_position)
<span class="comment-delimiter">#</span><span class="comment">-----------------------------
</span></PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="directories.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="referencesandrecords.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Directories</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>References and Records</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>